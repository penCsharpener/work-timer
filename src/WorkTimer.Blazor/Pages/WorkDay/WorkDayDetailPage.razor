@page "/workday/{WorkDayId:int}"
@inject global::MediatR.IMediator Mediator
@inject NavigationManager Navi;
@attribute [Authorize]

<h1>Work day details for @Model.WorkDay?.Date.DayOfWeek @Model.WorkDay?.Date.ToString("dd.MM.yyyy")</h1>

<table class="table table-striped table-hover table-sm">
    <thead>
        <tr>
            <th scope="col">Id</th>
            <th scope="col">Start Time</th>
            <th scope="col">End Time</th>
            <th scope="col">Length</th>
            <th scope="col">Comment</th>
            <th scope="col">Edit</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var period in Model.WorkingPeriods) {
            <tr>
                <th scope="row">@period.Id</th>
                <td>@period.StartTime.ToString()</td>
                <td>@period.EndTime.ToString()</td>
                <td>@period.WorkTime.ToTimeString()</td>
                <td>@period.Comment</td>
                <td onclick="location.href='/workday/@WorkDayId/workperiod/@(period.Id)'"><span class="oi oi-pencil" title="oi-pencil" aria-hidden="true"></span></td>
            </tr>
        }
    </tbody>
</table>

@code {

    [Parameter]
    public int WorkDayId { get; set; }

    public GetWorkDayDetailsResponse Model { get; set; }

    protected override async Task OnInitializedAsync() {
        Model = await Mediator.Send(new GetWorkDayDetailsRequest(WorkDayId));
    }
}
